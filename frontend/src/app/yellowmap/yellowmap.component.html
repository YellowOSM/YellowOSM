<form>
<div class="yosm__container">
  <mat-toolbar color="secondary" class="search__toolbar mat-elevation-z3" #toolbarElement>
    <a href="/" class="search__logo-wrapper">
      <img class="search__logo" src="assets/img/logo.svg" alt="YellowOSM - Open Locations">
    </a>
    <mat-form-field [floatLabel]="'never'" class="search__input">
      <input type="text" matInput placeholder="z.B. Café, Apotheke, Bankomat, Bar..." [formControl]="searchFormControl"
             [matAutocomplete]="auto" #searchInput [matAutocompleteConnectedTo]="origin"
             (keydown.enter)="searchElasticSearch()">
    </mat-form-field>
    <div class="search__button">
      <mat-icon *ngIf="searchFormControl.value" (click)="removeSearchText()" class="search__clear">close</mat-icon>
      <button type="submit">
        <mat-icon (click)="searchElasticSearch()">search</mat-icon>
      </button>
    </div>

  </mat-toolbar>

  <div class="yosm__autocomplete-wrapper" matAutocompleteOrigin #origin="matAutocompleteOrigin"></div>

  <mat-autocomplete #auto="matAutocomplete" panelWidth="100%" class="mat-elevation-z3">
    <mat-option *ngFor="let option of filteredOptions | async" [value]="option" (click)="searchElasticSearch()">
      {{option}}
    </mat-option>
  </mat-autocomplete>

  <mat-chip-list class="yosm__filters">
    <mat-chip [color]="showOnlyOpenedLocations ? 'accent': 'standard'" selected
              (click)="toogleOpenedLocations()">jetzt geöffnet</mat-chip>
  </mat-chip-list>

  <div class="map__wrapper">
    <div id="map" class="map" #mapElement></div>
    <div class="map__beta-sleeve mat-elevation-z2">BETA</div>
    <button mat-fab (click)="getLocation()" class="map__location-button">
      <mat-icon aria-label="Position finden">gps_fixed</mat-icon>
    </button>
    <div class="map__link map__osm-link">
      <a
        href="https://osm.org/#map={{previousUrlParams['zoom']}}/{{previousUrlParams['lat']}}/{{previousUrlParams['lon']}}"
        target="_blank">
        in OSM ansehen
      </a>
    </div>
    <div class="map__link map__contrib-link">
      © <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors
    </div>
  </div>
</div>
</form>

<app-location-detail [features]="features" [selectedFeature]="selectedFeature" [showFeatureList]="showFeatureList"
                     [draggedUp]="selectedFeatureDraggedUp" [style.top.px]="selectedFeatureTopPos"
                     [className]="getLocationClasses()"
                     (panstart)="onPanStart($event)" (panmove)="onPan($event)"
                     (goUp)="openFeature($event)" (goDown)="closeFeature($event)"
                     (closeFeature)="closeFeature($event)" (closeFeatureList)="closeFeatureList($event)"
                     #locationElement
                     *ngIf="showFeatureList || selectedFeature"
></app-location-detail>
